/*
 * Auto Complete [VERSION]
 * [DATE]
 * Corey Hart @ http://www.codenothing.com
 */
(function(j,W,i){function L(f,p){if(L.flag!==g){L.flag=g;M.bind("click.autoComplete",function(v){h.getFocus(g).trigger("autoComplete.document-click",[v])})}f=f.closest("form");var m=f.data("ac-inputs")||{},A;m[p]=g;f.data("ac-inputs",m);f.data("autoComplete")!==g&&f.data("autoComplete",g).bind("submit.autoComplete",function(v){return(A=h.getFocus(g)).length?A.triggerHandler("autoComplete.form-submit",[v,this]):g})}function da(f,p){h.remove(p);if(L.flag===g&&h.length===0){L.flag=q;M.unbind("click.autoComplete")}f=
f.closest("form");var m=f.data("ac-inputs"),A=-1,v=(m||[]).length;for(m[p]=q;++A<v;)if(m[A]===g)return;f.unbind("submit.autoComplete")}function Z(f,p){if(!j.isArray(p.supply))return[];f=-1;for(var m=p.supply.length,A=[],v;++f<m;){v=(v=p.supply[f])&&v.value?v:{value:v};A.push(v)}return A}j.fn.autoComplete=function(){var f=$.call(arguments),p=this,m=f.shift(),A=typeof m==="string",v,N;if(A)m=m.replace(ea,"-");f=h.arrayMethods[m]===g&&j.isArray(f[0])&&j.isArray(f[0][0])||f.length===1&&j.isArray(f[0])?
f[0]:f;v=A&&(h.handlerMethods[m]===-1||f.length<(h.handlerMethods[m]||0))?"triggerHandler":"trigger";return A?p[v]("autoComplete."+m,f):m&&m.preventDefault!==i?p.trigger(m,f):p.each(function(){if(j(N=this).data("autoComplete")!==g)fa(N,m)})};j.fn.bgiframe=j.fn.bgiframe?j.fn.bgiframe:j.fn.bgIframe?j.fn.bgIframe:function(){return this};var g=true,q=false,$=Array.prototype.slice,M=j(W.document),aa=j(),ea=/\./,x="autoComplete_"+j.expando,B={backspace:8,tab:9,enter:13,shift:16,space:32,pageup:33,pagedown:34,
left:37,up:38,right:39,down:40},h=j.autoComplete={version:"[VERSION]",counter:0,length:0,stack:{},jqStack:{},order:[],hasFocus:q,keys:B,arrayMethods:{"button-supply":g,"direct-supply":g},handlerMethods:{option:2},focus:i,blur:i,getFocus:function(f){return!h.order[0]?f?aa:i:f?h.jqStack[h.order[0]]:h.stack[h.order[0]]},getPrevious:function(f){for(var p=0,m=h.order.length;++p<m;)if(h.order[p])return f?h.jqStack[h.order[p]]:h.stack[h.order[p]];return f?aa:i},remove:function(f){for(var p=-1,m=h.order.length;++p<
m;)if(h.order[p]===f)h.order[p]=i;h.length--;delete h.stack[f]},getAll:function(){for(var f=-1,p=h.counter,m=[];++f<p;)h.stack[f]&&m.push(h.stack[f]);return j(m)},defaults:{backwardsCompatible:q,ajax:"ajax.php",ajaxCache:j.ajaxSettings.cache,dataSupply:[],dataFn:i,formatSupply:i,list:"auto-complete-list",rollover:"auto-complete-list-rollover",width:i,striped:i,maxHeight:i,bgiframe:i,newList:q,postVar:"value",postData:{},postFormat:i,minChars:1,maxItems:-1,maxRequests:0,requestType:"POST",inputControl:i,
autoFill:q,nonInput:[B.shift,B.left,B.right],multiple:q,multipleSeparator:" ",onBlur:i,onFocus:i,onHide:i,onLoad:i,onMaxRequest:i,onRollover:i,onSelect:i,onShow:i,onSubmit:function(){return g},spinner:i,onListFormat:i,preventEnterSubmit:g,delay:0,useCache:g,cacheLimit:50}},fa=function(f,p){function m(b,a,d,l,C){a.spinner&&a.spinner.call(f,b,{active:g,settings:a,cache:d,ul:e});if(R)R=clearTimeout(R);if(a.delay>0&&C===i)return R=W.setTimeout(function(){m(b,a,d,l,g)},a.delay);S&&S.abort();if(a.useCache&&
d.list[d.val])return T(b,d.list[d.val],a,d,l);if(a.dataSupply.length)return A(b,a,d,l);if(a.maxRequests&&++X>=a.maxRequests){e.html("").hide(b);a.spinner&&a.spinner.call(f,b,{active:q,settings:a,cache:d,ul:e});if(a.onMaxRequest&&X===a.maxRequests)return a.onMaxRequest.apply(f,a.backwardsCompatible?[d.val,e,b,w,a,d]:[b,{search:d.val,val:w,settings:a,cache:d,ul:e}]);return q}a.postData[a.postVar]=d.val;return S=j.ajax({type:a.requestType,url:a.ajax,cache:a.ajaxCache,dataType:"json",data:a.postFormat?
a.postFormat.call(f,b,{data:a.postData,search:d.val,val:w,settings:a,cache:d,ul:e}):a.postData,success:function(F){T(b,F,a,d,l)},error:function(){e.html("").hide(b);a.spinner&&a.spinner.call(f,b,{active:q,settings:a,cache:d,ul:e})}})}function A(b,a,d,l){var C=[],F=[],O=j.isFunction(a.dataFn),I=O?i:new RegExp("^"+d.val,"i"),P=0,D,U=-1,ga=a.dataSupply.length;if(a.formatSupply)C=a.formatSupply.call(f,b,{search:d.val,supply:a.dataSupply,settings:a,cache:d,ul:e});else for(;++U<ga;){D=a.dataSupply[U];D=
typeof D==="object"&&D.value?D:{value:D};F=a.backwardsCompatible?[d.val,D.value,C,U,a.dataSupply,e,b,a,d]:[b,{search:d.val,entry:D.value,list:C,i:U,supply:a.dataSupply,settings:a,cache:d,ul:e}];if(O&&a.dataFn.apply(f,F)||!O&&D.value.match(I)){if(a.maxItems>-1&&++P>a.maxItems)break;C.push(D)}}return T(b,C,a,d,l)}function v(b){if(y){if(c.onSelect)c.onSelect.apply(f,c.backwardsCompatible?[s,o,e,b,c,k]:[b,{data:s,li:o,settings:c,cache:k,ul:e}]);Q();w=t.val();if(n.type==="keydown")n["enter_"+x]=g;e.hide(b)}return o=
i}function N(b){o&&o.removeClass(c.rollover);e.show(b);o=G.eq(r).addClass(c.rollover);s=E[r];if(!o.length||!s)return q;Q(s.value);if(c.onRollover)c.onRollover.apply(f,c.backwardsCompatible?[s,o,e,b,c,k]:[b,{data:s,li:o,settings:c,cache:k,ul:e}]);b=r*J;if(b<K-V){K=b+V;e.scrollTop(b)}return o}function ba(b){o&&o.removeClass(c.rollover);e.show(b);o=G.eq(r).addClass(c.rollover);s=E[r];if(!o.length||!s)return q;Q(s.value);var a=(r+1)*J;if(a>K)e.scrollTop((K=a)-V);if(c.onRollover)c.onRollover.apply(f,c.backwardsCompatible?
[s,o,e,b,c,k]:[b,{data:s,li:o,settings:c,cache:k,ul:e}]);return o}function ca(){var b=e.hide,a=e.show,d=e.data("ac-inputs")||{};if(!e[x]){e.hide=function(l,C,F){c.onHide&&y&&c.onHide.call(f,l,{ul:e,settings:c,cache:k});y=q;return b.call(e,C,F)};e.show=function(l,C,F){c.onShow&&!y&&c.onShow.call(f,l,{ul:e,settings:c,cache:k});y=g;return a.call(e,C,F)};e[x]=g}e.data("autoComplete")!==g&&e.data("autoComplete",g).delegate("li","mouseenter.autoComplete",function(l){h.getFocus(g).trigger("autoComplete.ul-mouseenter",
[l,this])}).bind("click.autoComplete",function(l){h.getFocus(g).trigger("autoComplete.ul-click",[l]);return q});d[z]=g;return e.data("ac-inputs",d)}function Q(b){var a,d,l;if(b===i||b==="")a=d=t.val().length;else{if(H)b=w.substr(0,w.length-w.split(H).pop().length)+b+H;a=w.length;d=b.length;t.val(b)}if(!c.autoFill||a>d)return q;else if(f.createTextRange){l=f.createTextRange();if(b===i)l.move("character",a);else{l.collapse(g);l.moveStart("character",a);l.moveEnd("character",d)}l.select()}else if(f.setSelectionRange)f.setSelectionRange(a,
d);else if(f.selectionStart){f.selectionStart=a;f.selectionEnd=d}return g}function T(b,a,d,l,C){E=d.onLoad?d.onLoad.call(f,b,{list:a,settings:d,cache:l,ul:e}):a;d.spinner&&d.spinner.call(f,b,{active:q,settings:d,cache:l,ul:e});if(d.useCache&&l.list[l.val]===i){l.length++;l.list[l.val]=a;if(l.length>d.cacheLimit){l.list={};l.length=0}}if(!E||E.length<1)return e.html("").hide(b);r=-1;a=t.offset();var F=[],O=0,I=-1,P=q,D=E.length;if(d.onListFormat)d.onListFormat.call(f,b,{list:E,settings:d,cache:l,ul:e});
else{for(;++I<D;)if(E[I].value){if(d.maxItems>-1&&++O>d.maxItems)break;F.push(d.striped&&P?'<li class="'+d.striped+'">':"<li>",E[I].display||E[I].value,"</li>");P=!P}e.html(F.join(""))}G=e.children("li");if(d.autoFill&&!C){r=0;s=E[0];Q(s.value);o=G.eq(0).addClass(d.rollover)}e.data("ac-input-index",z).scrollTop(0).css({top:a.top+t.outerHeight(),left:a.left,width:d.width});J=G.eq(0).outerHeight();if(d.maxHeight)e.css({height:J*G.length>d.maxHeight?d.maxHeight:"auto",overflow:"auto"});K=V=e.outerHeight();
Y=J===0?0:Math.floor(K/J);n.timeStamp=(new Date).getTime();return e.show(b)}h.length++;h.counter++;var t=j(f).attr("autocomplete","off"),u={},n={},w="",E=[],G={length:0},o,K,V,J,Y,y=q,R,S,r=-1,s,H,z=h.counter,X=0,k={length:0,val:i,list:{}},c=j.extend({width:t.outerWidth()},h.defaults,p||{},j.metadata?t.metadata():{}),e=!c.newList&&M.find("ul."+c.list)[0]?M.find("ul."+c.list).eq(0).bgiframe(c.bgiframe):j("<ul/>").appendTo("body").addClass(c.list).bgiframe(c.bgiframe).hide().data("ac-selfmade",g);t.data("autoComplete",
u={index:z,hasFocus:q,active:g,settings:c,initialSettings:j.extend(g,{},c)}).bind(W.opera?"keypress.autoComplete":"keydown.autoComplete",function(b){if(!u.active)return g;var a=(n=b).keyCode,d=q;if(a===B.tab&&y)v(b);else if(a===B.enter){d=g;if(o&&o.hasClass(c.rollover)){d=c.preventEnterSubmit&&y?q:g;v(b)}else y&&e.hide(b)}else if(a===B.up&&y)if(r>0){r--;N(b)}else{r=-1;t.val(w);e.hide(b)}else if(a===B.down&&y){if(r<G.length-1){r++;ba(b)}}else if(a===B.pageup&&y){if(r>0){r-=Y;if(r<0)r=0;N(b)}}else if(a===
B.pagedown&&y){if(r<G.length-1){r+=Y;if(r>G.length-1)r=G.length-1;ba(b)}}else if(c.nonInput&&j.inArray(a,c.nonInput)>-1){e.html("").hide(b);d=g}else return g;n["keydown_"+x]=g;return d}).bind({"keyup.autoComplete":function(b){if(!u.active||n["keydown_"+x])return g;w=t.val();var a=(n=b).keyCode,d=H?w.split(H).pop():w;if(a!=B.enter){k.val=c.inputControl===i?d:c.inputControl.apply(f,c.backwardsCompatible?[d,a,e,b,c,k]:[b,{val:d,key:a,settings:c,cache:k,ul:e}]);if(k.val.length>=c.minChars)m(b,c,k,a===
B.backspace||a===B.space);else a==B.backspace&&e.html("").hide(b)}},"blur.autoComplete":function(b){if(!u.active||y)return g;h.order[0]!==i&&h.order.unshift(i);h.hasFocus=q;u.hasFocus=q;r=-1;e.hide(n=b);h.blur&&h.blur.call(f,b,{settings:c,cache:k,ul:e});if(c.onBlur)c.onBlur.apply(f,c.backwardsCompatible?[w,e,b,c,k]:[b,{val:w,settings:c,cache:k,ul:e}])},"focus.autoComplete":function(b,a){if(!u.active||u.hasFocus&&a===x||n["enter_"+x])return g;z!==e.data("ac-input-index")&&e.html("").hide(b);if(h.order[0]===
i)if(h.order[1]===z)h.order.shift();else h.order[0]=z;else h.order[0]!=z&&h.order[1]!=z&&h.order.unshift(z);h.order.length>h.defaults.cacheLimit&&h.order.pop();h.hasFocus=g;u.hasFocus=g;n=b;h.focus&&h.focus.call(f,b,{settings:c,cache:k,ul:e});if(c.onFocus)c.onFocus.apply(f,c.backwardsCompatible?[e,b,c,k]:[b,{settings:c,cache:k,ul:e}])},"autoComplete.document-click":function(b,a){if(u.active&&y&&(!n||a.timeStamp-n.timeStamp>200)&&j(a.target).closest("ul").data("ac-input-index")!==z){e.hide(n=a);t.blur()}},
"autoComplete.form-submit":function(b,a,d){if(!u.active)return g;n=a;return c.preventEnterSubmit&&(y||n["enter_"+x])?q:c.onSubmit.call(f,a,{form:d,settings:c,cache:k,ul:e})},"autoComplete.ul-mouseenter":function(b,a,d){o&&o.removeClass(c.rollover);o=j(d).addClass(c.rollover);r=G.index(d);s=E[r];if(c.onRollover)c.onRollover.apply(f,c.backwardsCompatible?[s,o,e,a,c,k]:[a,{data:s,li:o,settings:c,cache:k,ul:e}]);return n=a},"autoComplete.ul-click":function(b,a){t.trigger("focus",[x]);t.val(w===H?w.substr(0,
w.length-w.split(H).pop().length)+s.value+H:s.value);e.hide(a);Q();if(c.onSelect)c.onSelect.apply(f,c.backwardsCompatible?[s,o,e,a,c,k]:[a,{data:s,li:o,settings:c,cache:k,ul:e}]);return n=a},"autoComplete.settings":function(b,a){if(!u.active)return g;var d;if(j.isFunction(a)){a=a.apply(f,c.backwardsCompatible?[c,k,e,b]:[b,{settings:c,cache:k,ul:e}]);if(j.isArray(a)&&a[0]!==i){j.extend(g,c,a[0]||c);j.extend(g,k,a[1]||k)}}else j.extend(g,c,a||{});e=!c.newList&&e.hasClass(c.list)?e:!c.newList&&(d=M.find("ul."+
c.list).eq(0)).length?d.bgiframe(c.bgiframe):j("<ul/>").appendTo("body").addClass(c.list).bgiframe(c.bgiframe).hide().data("ac-selfmade",g);ca();c.requestType=c.requestType.toUpperCase();H=c.multiple?c.multipleSeparator:i;u.settings=c;return n=b},"autoComplete.flush":function(b,a){if(!u.active)return g;a||(X=0);k={length:0,val:i,list:{}};return n=b},"autoComplete.button-ajax":function(b,a,d){if(!u.active)return g;if(typeof a==="string"){d=a;a={}}n=b;t.trigger("focus",[x]);k.val=d||"button-ajax_"+
x;return m(b,j.extend(g,{},c,{maxItems:-1,postData:a||{}}),k)},"autoComplete.button-supply":function(b,a,d){if(!u.active)return g;if(typeof a==="string"){d=a;a=i}n=b;t.trigger("focus",[x]);k.val=d||"button-supply_"+x;a=j.isArray(a)?a:c.dataSupply;return m(b,j.extend(g,{},c,{maxItems:-1,dataSupply:a,formatSupply:Z}),k)},"autoComplete.direct-supply":function(b,a,d){if(!u.active)return g;if(typeof a==="string"){d=a;a=i}n=b;t.trigger("focus",[x]);k.val=d||"direct-supply_"+x;a=j.isArray(a)&&a.length?a:
c.dataSupply;return T(b,a,j.extend(g,{},c,{maxItems:-1,dataSupply:a,formatSupply:Z}),k)},"autoComplete.search":function(b,a){if(!u.active)return g;k.val=a||"";return m(n=b,c,k)},"autoComplete.option":function(b,a,d){if(!u.active)return g;var l=$.call(arguments).length;n=b;if(l===3)return c[a]=d;else if(l===2)switch(a){case "ul":return e;case "cache":return k;case "xhr":return S;case "input":return t;default:return c[a]||i}else return c},"autoComplete.enable":function(b){u.active=g;return n=b},"autoComplete.disable":function(b){u.active=
q;e.html("").hide(b);return n=b},"autoComplete.destroy":function(b){b=e.html("").hide(n=b).data("ac-inputs")||{};var a;t.removeData("autoComplete").unbind(".autoComplete autoComplete");da(t,z);b[z]=i;for(a in b)if(b.hasOwnProperty(a)&&b[a]===g)return n;e.data("ac-selfmade")===g?e.remove():e.removeData("autoComplete").removeData("ac-input-index").removeData("ac-inputs");return n}});ca();c.requestType=c.requestType.toUpperCase();H=c.multiple?c.multipleSeparator:i;h.stack[z]=f;h.jqStack[z]=t;L(t,z)}})(jQuery,
window||this);
