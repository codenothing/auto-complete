(function(h,V,g){h.fn.autoComplete=function(){var n=W.call(arguments),w=this,t=n.shift(),M=typeof t==="string";if(M)t=t.replace(".","-");n=t==="button-supply"||t==="direct-supply"?h.isArray(n[0])&&h.isArray(n[0][0])?n[0]:n:n[1]===g&&h.isArray(n[0])?n[0]:n;return M?w[t==="option"&&n.length<2?"triggerHandler":"trigger"]("autoComplete."+t,n):t&&t[h.expando]?w.trigger(t,n):w.each(function(){$.call(this,t)})};h.fn.bgiframe=h.fn.bgiframe?h.fn.bgiframe:h.fn.bgIframe?h.fn.bgIframe:function(){return this};
var f=true,p=false,W=Array.prototype.slice,y=h.expando+"_autoComplete",F={backspace:8,tab:9,enter:13,space:32,pageup:33,pagedown:34,up:38,down:40},i=h.autoComplete={version:"[VERSION]",counter:0,length:0,stack:{},order:[],hasFocus:p,getFocus:function(){return this.order[0]?this.stack[this.order[0]]:g},getPrevious:function(){for(var n=0,w=i.order.length;++n<w;)if(i.order[n])return i.stack[i.order[n]];return g},remove:function(n){for(var w=-1,t=i.order.length;++w<t;)if(i.order[w]===n)i.order[w]=g;i.stack[n]=
g;i.length--;delete i.stack[n]},getAll:function(){for(var n=-1,w=i.counter,t=[];++n<w;)i.stack[n]&&t.push(i.stack[n]);return h(t)},defaults:{backwardsCompatible:p,ajax:"ajax.php",ajaxCache:h.ajaxSettings.cache,dataSupply:[],dataFn:g,list:"auto-complete-list",rollover:"auto-complete-list-rollover",width:g,striped:g,maxHeight:g,newList:p,postVar:"value",postData:{},postFormat:g,minChars:1,maxItems:-1,maxRequests:0,requestType:"POST",inputControl:g,autoFill:p,nonInput:g,multiple:p,multipleSeparator:" ",
onBlur:g,onFocus:g,onHide:g,onLoad:g,onMaxRequest:g,onRollover:g,onSelect:g,onShow:g,onSubmit:function(){return f},spinner:g,onListFormat:g,preventEnterSubmit:f,delay:0,useCache:f,cacheLimit:50}},$=function(n){function w(b,a,c,l,z){a.spinner&&a.spinner.call(j,b,{active:f,ul:d});if(I)I=clearTimeout(I);if(a.delay>0&&z===g)return I=V.setTimeout(function(){w(b,a,c,l,f);I=clearTimeout(I)},a.delay);Q&&Q.abort();if(a.useCache&&c.list[c.val])return R(b,c.list[c.val],a,c,l);if(a.dataSupply.length)return t(b,
a,c,l);if(a.maxRequests&&++T>=a.maxRequests){d.html("").hide(b);a.spinner&&a.spinner.call(j,b,{active:p,ul:d});if(a.onMaxRequest&&T===a.maxRequests)return a.onMaxRequest.apply(j,a.backwardsCompatible?[c.val,d,b,u]:[b,{search:c.val,val:u,ul:d}]);return p}a.postData[a.postVar]=c.val;return Q=h.ajax({type:a.requestType,url:a.ajax,cache:a.ajaxCache,dataType:"json",data:a.postFormat?a.postFormat.call(j,b,{data:a.postData,search:c.val,val:u,ul:d}):a.postData,success:function(C){R(b,C,a,c,l)},error:function(){d.html("").hide(b);
a.spinner&&a.spinner.call(j,b,{active:p,ul:d})}})}function t(b,a,c,l){for(var z=[],C=[],N=h.isFunction(a.dataFn),J=N?g:new RegExp("^"+c.val,"i"),O=0,A,D=-1,aa=a.dataSupply.length;++D<aa;){A=a.dataSupply[D];A=typeof A==="object"&&A.value?A:{value:A};C=a.backwardsCompatible?[c.val,A.value,z,D,a.dataSupply,d,b]:[b,{val:c.val,entry:A.value,list:z,i:D,supply:a.dataSupply,ul:d}];if(N&&a.dataFn.apply(j,C)||!N&&A.value.match(J)){if(a.maxItems>-1&&++O>a.maxItems)break;z.push(A)}}return R(b,z,a,c,l)}function M(b){if(G){if(e.onSelect)e.onSelect.apply(j,
e.backwardsCompatible?[r,k,d,b]:[b,{data:r,li:k,ul:d}]);P(g);u=q.val();if(m.type==="keydown")m[y+"_enter"]=f}d.hide(b);return k}function X(b){k&&k.removeClass(e.rollover);d.show(b);k=E.eq(o).addClass(e.rollover);r=B[o];if(!k.length||!r)return p;P(r.value||"");if(e.onRollover)e.onRollover.apply(j,e.backwardsCompatible?[r,k,d,b]:[b,{data:r,li:k,ul:d}]);b=o*K;if(b<L-S){L=b+S;d.scrollTop(b)}return k}function Y(b){k&&k.removeClass(e.rollover);d.show(b);k=E.eq(o).addClass(e.rollover);r=B[o];if(!k.length||
!r)return p;P(r.value||"");var a=(o+1)*K;if(a>L)d.scrollTop((L=a)-S);if(e.onRollover)e.onRollover.apply(j,e.backwardsCompatible?[r,k,d,b]:[b,{data:r,li:k,ul:d}]);return k}function Z(){var b=d.hide,a=d.show,c=d.data("ac-inputs")||{};if(!d[y]){d.hide=function(l,z,C){if(e.onHide&&G){e.onHide.call(j,l,{ul:d});m[y+"_hide"]=f}G=p;return b.call(d,z,C)};d.show=function(l,z,C){e.onShow&&!G&&e.onShow.call(j,l,{ul:d});G=f;return a.call(d,z,C)};d[y]=f}c[s]=f;return d.data("ac-inputs",c)}function P(b){var a,c,
l;if(b===g)a=c=q.val().length;else{if(H)b=u.substr(0,u.length-u.split(H).pop().length)+b+H;a=u.length;c=b.length;q.val(b)}if(!e.autoFill||a>c)return p;else if(j.createTextRange){l=j.createTextRange();if(b===g)l.move("character",a);else{l.collapse(f);l.moveStart("character",a);l.moveEnd("character",c)}l.select()}else if(j.setSelectionRange)j.setSelectionRange(a,c);else if(j.selectionStart){j.selectionStart=a;j.selectionEnd=c}return f}function R(b,a,c,l,z){B=c.onLoad?c.onLoad.call(j,b,{list:a,settings:c,
cache:l,ul:d}):a;c.spinner&&c.spinner.call(j,b,{active:p,ul:d});if(c.useCache&&l.list[l.val]===g){l.length++;l.list[l.val]=a;if(l.length>c.cacheLimit){l.list={};l.length=0}}if(!B||B.length<1)return d.html("").hide(b);o=-1;a=q.offset();var C=[],N=0,J=-1,O=p,A=B.length;if(c.onListFormat)c.onListFormat.call(j,b,{list:B,settings:c,cache:l,ul:d});else{for(;++J<A;)if(B[J].value){if(c.maxItems>-1&&++N>c.maxItems)break;C.push(c.striped&&O?'<li class="'+c.striped+'">':"<li>",B[J].display||B[J].value,"</li>");
O=!O}d.html(C.join(""))}E=d.children("li");if(c.autoFill&&!z){o=0;r=B[0];P(r.value||"");k=E.eq(0).addClass(c.rollover)}d.unbind(".autoComplete").data("ac-input-index",s).delegate("li","mouseleave.autoComplete",function(){k&&k.removeClass(c.rollover)}).delegate("li","mouseenter.autoComplete",function(D){k&&k.removeClass(c.rollover);k=h(this).addClass(c.rollover);o=E.index(k[0]);r=B[o];if(c.onRollover)c.onRollover.apply(j,c.backwardsCompatible?[r,k,d,D]:[D,{data:r,li:k,ul:d}])}).bind("click.autoComplete",
function(D){q.trigger("focus",[y]);q.val(u=H?u.substr(0,u.length-u.split(H).pop().length)+r.value+H:r.value);d.hide(D);P(g);if(c.onSelect)c.onSelect.apply(j,c.backwardsCompatible?[r,k,d,D]:[D,{data:r,li:k,ul:d}])}).css({top:a.top+q.outerHeight(),left:a.left,width:c.width}).scrollTop(0);K=E.eq(0).outerHeight();if(c.maxHeight)d.css({height:K*E.length>c.maxHeight?c.maxHeight:"auto",overflow:"auto"});L=S=d.outerHeight();U=K===0?0:Math.floor(L/K);m.timeStamp=(new Date).getTime();return d.show(b)}i.length++;
i.counter++;var j=this,q=h(j).attr("autocomplete","off"),x=f,m={},u="",B=[],E={length:0},k,L,S,K,U,G=p,I,Q,o=-1,r,H,s=i.counter,T=0,v={length:0,val:g,list:{}},e=h.extend({width:q.outerWidth()},i.defaults,n||{},h.metadata?q.metadata():{}),d=!e.newList&&h("ul."+e.list)[0]?h("ul."+e.list).eq(0).bgiframe().data("autoComplete",f):h("<ul/>").appendTo("body").addClass(e.list).bgiframe().hide().data({"ac-selfmade":f,autoComplete:f}),ba=h(document).bind("click.autoComplete-"+s,function(b){var a;if(x&&G&&(!m||
b.timeStamp-m.timeStamp>200)&&(a=h(b.target)).closest("ul").data("ac-input-index")!==s&&a.data("ac-input-index")!==s){d.hide(b);q.blur()}m=b});q.data({autoComplete:f,"ac-input-index":s,"ac-active":x,"ac-initial-settings":h.extend(f,{},e),"ac-settings":e}).bind(V.opera?"keypress.autoComplete":"keydown.autoComplete",function(b){if(!x)return f;var a=(m=b).keyCode,c=p;if(a===F.tab&&G)M(b);else if(a===F.enter&&k){c=e.preventEnterSubmit&&G?p:f;M(b)}else if(a===F.up)if(o>0){o--;X(b)}else{o=-1;q.val(u);d.hide(b)}else if(a===
F.down){if(o<E.length-1){o++;Y(b)}}else if(a===F.pageup){if(o>0){o-=U;if(o<0)o=0;X(b)}}else if(a===F.pagedown){if(o<E.length-1){o+=U;if(o>E.length-1)o=E.length-1;Y(b)}}else if(e.nonInput&&h.inArray(a,e.nonInput))d.html("").hide(b);else return f;m[y+"_keydown"]=f;return c}).bind({"keyup.autoComplete":function(b){if(!x||m[y+"_keydown"])return f;u=q.val();var a=(m=b).keyCode,c=H?u.split(H).pop():u;if(a!=F.enter){v.val=e.inputControl===g?c:e.inputControl.apply(j,e.backwardsCompatible?[c,a,d,b]:[b,{val:c,
key:a,ul:d}]);if(v.val.length>=e.minChars)w(b,e,v,a===F.backspace||a===F.space);else a==F.backspace&&d.html("").hide(b)}},"blur.autoComplete":function(b){if(!x||G)return f;m=b;q.data("ac-hasFocus",p);o=-1;i.order[0]!==g&&i.order.unshift(g);i.hasFocus=p;d.hide(b);if(e.onBlur)e.onBlur.apply(j,e.backwardsCompatible?[u,d,b]:[b,{val:u,ul:d}])},"focus.autoComplete":function(b,a){if(!x||i.focus===s&&a===y||m[y+"_enter"])return f;m=b;s!=d.data("ac-input-index")&&d.html("").hide(b);if(i.order[0]===g)if(i.order[1]===
s)i.order.shift();else i.order[0]=s;else i.order[0]!=s&&i.order[1]!=s&&i.order.unshift(s);i.order.length>i.defaults.cacheLimit&&i.order.pop();i.hasFocus=f;q.data("ac-hasFocus",f);if(e.onFocus)e.onFocus.apply(j,e.backwardsCompatible?[d,b]:[b,{ul:d}])},"autoComplete.settings":function(b,a){if(!x)return f;if(h.isFunction(a)){a=a.apply(j,e.backwardsCompatible?[e,v,d,b]:[b,{settings:e,cache:v,ul:d}]);if(h.isArray(a)&&a[0]!==g){e=h.extend(f,{},e,a[0]||e);v=h.extend(f,{},v,a[1]||v)}}else e=h.extend(f,{},
e,a||{});d=!e.newList&&d.hasClass(e.list)?d:!e.newList&&h("ul."+e.list)[0]?h("ul."+e.list).bgiframe().data("autoComplete",f):h("<ul/>").appendTo("body").addClass(e.list).bgiframe().hide().data({"ac-selfmade":f,autoComplete:f});Z();e.requestType=e.requestType.toUpperCase();H=e.multiple?e.multipleSeparator:g;q.data("ac-settings",e);return m=b},"autoComplete.flush":function(b,a){if(!x)return f;a||(T=0);v={length:0,val:g,list:{}};return m=b},"autoComplete.button-ajax":function(b,a,c){if(!x)return f;if(typeof a===
"string"){c=a;a={}}m=b;q.trigger("focus",[y]);v.val=c||y+"_button-ajax";return w(b,h.extend(f,{},e,{maxItems:-1,postData:a||{}}),v)},"autoComplete.button-supply":function(b,a,c){if(!x)return f;if(typeof a==="string"){c=a;a=g}m=b;q.trigger("focus",[y]);v.val=c||y+"_button-supply";a=h.isArray(a)&&a.length?a:e.dataSupply;return w(b,h.extend(f,{},e,{maxItems:-1,dataSupply:a,dataFn:function(){return f}}),v)},"autoComplete.direct-supply":function(b,a,c){if(!x)return f;if(typeof a==="string"){c=a;a=g}m=
b;q.trigger("focus",[y]);v.val=c||y+"_direct-supply";a=h.isArray(a)&&a.length?a:e.dataSupply;return R(b,a,h.extend(f,{},e,{maxItems:-1,dataSupply:a,dataFn:function(){return f}}),v)},"autoComplete.search":function(b,a){if(!x)return f;v.val=a||"";return w(m=b,e,v)},"autoComplete.option":function(b){if(!x)return f;var a=W.call(arguments),c=a.length;m=b;if(c===3){e[a[1]]=a[2];return a[2]}else if(c===2)switch(a[1]){case "ul":return d;case "cache":return v;case "xhr":return Q;case "input":return q;default:return e[a[1]]||
g}else return e},"autoComplete.enable":function(b){q.data("ac-active",x=f);return m=b},"autoComplete.disable":function(b){q.data("ac-active",x=p);d.html("").hide(b);return m=b},"autoComplete.destroy":function(b){var a=d.html("").hide(b).data("ac-inputs"),c;q.removeData("autoComplete").removeData("ac-input-index").removeData("ac-initial-settings").removeData("ac-settings").removeData("ac-active").unbind(".autoComplete autoComplete").closest("form").unbind("submit.autoComplete-"+s);ba.unbind("click.autoComplete-"+
s);i.remove(s);x=p;a[s]=g;m=b;for(c in a)if(a.hasOwnProperty(c)&&a[c]===f)return m;d.data("ac-selfmade")===f&&d.remove();return m}}).closest("form").bind("submit.autoComplete-"+s,function(b){if(!x)return f;var a=m[y+"_enter"]||p;m=b;return e.preventEnterSubmit?G||a?p:e.onSubmit.call(j,b,{form:this,ul:d}):e.onSubmit.call(j,b,{form:this,ul:d})});Z();e.requestType=e.requestType.toUpperCase();H=e.multiple?e.multipleSeparator:g;i.stack[s]=j}})(jQuery,window||this);
