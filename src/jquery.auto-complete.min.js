/*
 * Auto Complete [VERSION]
 * [DATE]
 * Corey Hart @ http://www.codenothing.com
 */
(function(e,i,a){e.fn.autoComplete=function(){var p=h.call(arguments),o=this,r=p.shift(),q=typeof r==="string";if(q){r=r.replace(".","-")}p=r==="button-supply"||r==="direct-supply"?e.isArray(p[0])&&e.isArray(p[0][0])?p[0]:p:p[1]===a&&e.isArray(p[0])?p[0]:p;return q?o[r==="option"&&p.length<2?"triggerHandler":"trigger"]("autoComplete."+r,p):r&&r[e.expando]?o.trigger(r,p):o.each(function(){f(this,r)})};e.fn.bgiframe=e.fn.bgiframe?e.fn.bgiframe:e.fn.bgIframe?e.fn.bgIframe:function(){return this};function b(s,q){if(b.flag!==c){b.flag=c;m.bind("click.autoComplete",function(t){e(g.getFocus()).trigger("autoComplete.document-click",[t])})}var o=s.closest("form"),r=o.data("ac-inputs")||[],p;r[q]=c;o.data("ac-inputs",r);if(o.data("autoComplete")!==c){o.bind("submit.autoComplete",function(t){return(p=e(g.getFocus())).length?p.triggerHandler("autoComplete.form-submit",[t]):c})}}function l(t,r){if(b.flag===c&&g.length===0){b.flag=j;m.unbind("click.autoComplete")}var p=t.closest("form"),s=p.data("ac-inputs"),q=-1,o=(s||[]).length;s[r]=j;for(;++q<o;){if(s[q]===c){return}}p.unbind("submit.autoComplete")}function k(s,t){if(!e.isArray(t.supply)){return[]}for(var q=-1,o=t.supply.length,p=[],r;++q<o;){r=t.supply[q];r=r&&r.value?r:{value:r};p.push(r)}return p}var c=true,j=false,h=Array.prototype.slice,m=e(i.document),n="autoComplete_"+e.expando,d={backspace:8,tab:9,enter:13,space:32,pageup:33,pagedown:34,up:38,down:40},g=e.autoComplete={version:"[VERSION]",counter:0,length:0,stack:{},order:[],hasFocus:j,getFocus:function(){return g.order[0]?g.stack[g.order[0]]:a},getPrevious:function(){for(var p=0,o=g.order.length;++p<o;){if(g.order[p]){return g.stack[g.order[p]]}}return a},remove:function(q){for(var p=-1,o=g.order.length;++p<o;){if(g.order[p]===q){g.order[p]=a}}g.stack[q]=a;g.length--;delete g.stack[q]},getAll:function(){for(var q=-1,p=g.counter,o=[];++q<p;){if(g.stack[q]){o.push(g.stack[q])}}return e(o)},defaults:{backwardsCompatible:j,ajax:"ajax.php",ajaxCache:e.ajaxSettings.cache,dataSupply:[],dataFn:a,formatSupply:a,list:"auto-complete-list",rollover:"auto-complete-list-rollover",width:a,striped:a,maxHeight:a,newList:j,postVar:"value",postData:{},postFormat:a,minChars:1,maxItems:-1,maxRequests:0,requestType:"POST",inputControl:a,autoFill:j,nonInput:a,multiple:j,multipleSeparator:" ",onBlur:a,onFocus:a,onHide:a,onLoad:a,onMaxRequest:a,onRollover:a,onSelect:a,onShow:a,onSubmit:function(){return c},spinner:a,onListFormat:a,preventEnterSubmit:c,delay:0,useCache:c,cacheLimit:50}},f=function(I,s){g.length++;g.counter++;var o=e(I).attr("autocomplete","off"),M=c,w={},E="",v=[],F={length:0},B,D,T,p,L,O=j,N,x,u=-1,t,r,H=g.counter,q=0,G={length:0,val:a,list:{}},Q=e.extend({width:o.outerWidth()},g.defaults,s||{},e.metadata?o.metadata():{}),A=!Q.newList&&e("ul."+Q.list)[0]?e("ul."+Q.list).eq(0).bgiframe().data("autoComplete",c):e("<ul/>").appendTo("body").addClass(Q.list).bgiframe().hide().data({"ac-selfmade":c,autoComplete:c});o.data({autoComplete:c,"ac-input-index":H,"ac-active":M,"ac-initial-settings":e.extend(c,{},Q),"ac-settings":Q}).bind(i.opera?"keypress.autoComplete":"keydown.autoComplete",function(V){if(!M){return c}var U=(w=V).keyCode,W=j;if(U===d.tab&&O){K(V)}else{if(U===d.enter&&B){W=Q.preventEnterSubmit&&O?j:c;K(V)}else{if(U===d.up){if(u>0){u--;z(V)}else{u=-1;o.val(E);A.hide(V)}}else{if(U===d.down){if(u<F.length-1){u++;C(V)}}else{if(U===d.pageup){if(u>0){u-=L;if(u<0){u=0}z(V)}}else{if(U===d.pagedown){if(u<F.length-1){u+=L;if(u>F.length-1){u=F.length-1}C(V)}}else{if(Q.nonInput&&e.inArray(U,Q.nonInput)){A.html("").hide(V)}else{return c}}}}}}}w["keydown_"+n]=c;return W}).bind({"keyup.autoComplete":function(V){if(!M||w["keydown_"+n]){return c}E=o.val();var U=(w=V).keyCode,W=r?E.split(r).pop():E;if(U!=d.enter){G.val=Q.inputControl===a?W:Q.inputControl.apply(I,Q.backwardsCompatible?[W,U,A,V,Q,G]:[V,{val:W,key:U,settings:Q,cache:G,ul:A}]);if(G.val.length>=Q.minChars){R(V,Q,G,(U===d.backspace||U===d.space))}else{if(U==d.backspace){A.html("").hide(V)}}}},"blur.autoComplete":function(U){if(!M||O){return c}w=U;o.data("ac-hasFocus",j);u=-1;if(g.order[0]!==a){g.order.unshift(a)}g.hasFocus=j;A.hide(U);if(Q.onBlur){Q.onBlur.apply(I,Q.backwardsCompatible?[E,A,U,Q,G]:[U,{val:E,settings:Q,cache:G,ul:A}])}},"focus.autoComplete":function(V,U){if(!M||(g.focus===H&&U===n)||w["enter_"+n]){return c}w=V;if(H!==A.data("ac-input-index")){A.html("").hide(V)}if(g.order[0]===a){if(g.order[1]===H){g.order.shift()}else{g.order[0]=H}}else{if(g.order[0]!=H&&g.order[1]!=H){g.order.unshift(H)}}if(g.order.length>g.defaults.cacheLimit){g.order.pop()}g.hasFocus=c;o.data("ac-hasFocus",c);if(Q.onFocus){Q.onFocus.apply(I,Q.backwardsCompatible?[A,V,Q,G]:[V,{settings:Q,cache:G,ul:A}])}},"autoComplete.document-click":function(V,U){if(M&&O&&(!w||U.timeStamp-w.timeStamp>200)&&e(U.target).closest("ul").data("ac-input-index")!==H){A.hide(U);w=U;o.blur()}},"autoComplete.form-submit":function(V,U){if(!M){return c}w=U;return Q.preventEnterSubmit&&(O||w["enter_"+n])?j:Q.onSubmit.call(I,U,{form:this,settings:Q,cache:G,ul:A})},"autoComplete.settings":function(X,U){if(!M){return c}var V,W;if(e.isFunction(U)){V=U.apply(I,Q.backwardsCompatible?[Q,G,A,X]:[X,{settings:Q,cache:G,ul:A}]);if(e.isArray(V)&&V[0]!==a){Q=e.extend(c,{},Q,V[0]||Q);G=e.extend(c,{},G,V[1]||G)}}else{Q=e.extend(c,{},Q,U||{})}A=!Q.newList&&A.hasClass(Q.list)?A:!Q.newList&&(W=e("ul."+Q.list).eq(0)).length?W.bgiframe().data("autoComplete",c):e("<ul/>").appendTo("body").addClass(Q.list).bgiframe().hide().data({"ac-selfmade":c,autoComplete:c});y();Q.requestType=Q.requestType.toUpperCase();r=Q.multiple?Q.multipleSeparator:a;o.data("ac-settings",Q);return(w=X)},"autoComplete.flush":function(U,V){if(!M){return c}if(!V){q=0}G={length:0,val:a,list:{}};return(w=U)},"autoComplete.button-ajax":function(V,U,W){if(!M){return c}if(typeof U==="string"){W=U;U={}}w=V;o.trigger("focus",[n]);G.val=W||"button-ajax_"+n;return R(V,e.extend(c,{},Q,{maxItems:-1,postData:U||{}}),G)},"autoComplete.button-supply":function(U,V,W){if(!M){return c}if(typeof V==="string"){W=V;V=a}w=U;o.trigger("focus",[n]);G.val=W||"button-supply_"+n;V=e.isArray(V)&&V.length?V:Q.dataSupply;return R(U,e.extend(c,{},Q,{maxItems:-1,dataSupply:V,formatSuppy:k}),G)},"autoComplete.direct-supply":function(U,V,W){if(!M){return c}if(typeof V==="string"){W=V;V=a}w=U;o.trigger("focus",[n]);G.val=W||"direct-supply_"+n;V=e.isArray(V)&&V.length?V:Q.dataSupply;return S(U,V,e.extend(c,{},Q,{maxItems:-1,dataSupply:V,formatSuppy:k}),G)},"autoComplete.search":function(U,V){if(!M){return c}G.val=V||"";return R(w=U,Q,G)},"autoComplete.option":function(W){if(!M){return c}var U=h.call(arguments),V=U.length;w=W;if(V===3){Q[U[1]]=U[2];return U[2]}else{if(V===2){switch(U[1]){case"ul":return A;case"cache":return G;case"xhr":return x;case"input":return o;default:return Q[U[1]]||a}}else{return Q}}},"autoComplete.enable":function(U){o.data("ac-active",M=c);return(w=U)},"autoComplete.disable":function(U){o.data("ac-active",M=j);A.html("").hide(U);return(w=U)},"autoComplete.destroy":function(V){var W=A.html("").hide(V).data("ac-inputs"),U;o.removeData("autoComplete").removeData("ac-input-index").removeData("ac-initial-settings").removeData("ac-settings").removeData("ac-active").unbind(".autoComplete autoComplete").closest("form").unbind("submit.autoComplete-"+H);g.remove(H);l(o,H);M=j;W[H]=a;w=V;for(U in W){if(W.hasOwnProperty(U)&&W[U]===c){return w}}if(A.data("ac-input-index")===H){A.removeData("ac-input-index")}if(A.data("ac-selfmade")===c){A.remove()}return w}});function R(W,V,U,Y,X){if(V.spinner){V.spinner.call(I,W,{active:c,settings:V,cache:U,ul:A})}if(N){N=clearTimeout(N)}if(V.delay>0&&X===a){N=i.setTimeout(function(){R(W,V,U,Y,c);N=clearTimeout(N)},V.delay);return N}if(x){x.abort()}if(V.useCache&&U.list[U.val]){return S(W,U.list[U.val],V,U,Y)}if(V.dataSupply.length){return P(W,V,U,Y)}if(V.maxRequests&&++q>=V.maxRequests){A.html("").hide(W);if(V.spinner){V.spinner.call(I,W,{active:j,settings:V,cache:U,ul:A})}if(V.onMaxRequest&&q===V.maxRequests){return V.onMaxRequest.apply(I,V.backwardsCompatible?[U.val,A,W,E,V,U]:[W,{search:U.val,val:E,settings:V,cache:U,ul:A}])}return j}V.postData[V.postVar]=U.val;x=e.ajax({type:V.requestType,url:V.ajax,cache:V.ajaxCache,dataType:"json",data:V.postFormat?V.postFormat.call(I,W,{data:V.postData,search:U.val,val:E,settings:V,cache:U,ul:A}):V.postData,success:function(Z){S(W,Z,V,U,Y)},error:function(){A.html("").hide(W);if(V.spinner){V.spinner.call(I,W,{active:j,settings:V,cache:U,ul:A})}}});return x}function P(V,Y,U,X){var ab=[],ac=[],ad=e.isFunction(Y.dataFn),ae=ad?a:new RegExp("^"+U.val,"i"),Z=0,af,aa=-1,W=Y.dataSupply.length;if(Y.formatSupply){ab=Y.formatSupply.call(I,V,{search:U.val,supply:Y.dataSupply,settings:Y,cache:U,ul:A})}else{for(;++aa<W;){af=Y.dataSupply[aa];af=typeof af==="object"&&af.value?af:{value:af};ac=Y.backwardsCompatible?[U.val,af.value,ab,aa,Y.dataSupply,A,V,Y,U]:[V,{search:U.val,entry:af.value,list:ab,i:aa,supply:Y.dataSupply,settings:Y,cache:U,ul:A}];if((ad&&Y.dataFn.apply(I,ac))||(!ad&&af.value.match(ae))){if(Y.maxItems>-1&&++Z>Y.maxItems){break}ab.push(af)}}}return S(V,ab,Y,U,X)}function K(U){if(O){if(Q.onSelect){Q.onSelect.apply(I,Q.backwardsCompatible?[t,B,A,U,Q,G]:[U,{data:t,li:B,settings:Q,cache:G,ul:A}])}J();E=o.val();if(w.type==="keydown"){w["enter_"+n]=c}}return A.hide(U)}function z(V){if(B){B.removeClass(Q.rollover)}A.show(V);B=F.eq(u).addClass(Q.rollover);t=v[u];if(!B.length||!t){return j}J(t.value);if(Q.onRollover){Q.onRollover.apply(I,Q.backwardsCompatible?[t,B,A,V,Q,G]:[V,{data:t,li:B,settings:Q,cache:G,ul:A}])}var U=u*p;if(U<D-T){D=U+T;A.scrollTop(U)}return B}function C(V){if(B){B.removeClass(Q.rollover)}A.show(V);B=F.eq(u).addClass(Q.rollover);t=v[u];if(!B.length||!t){return j}J(t.value);var U=(u+1)*p;if(U>D){A.scrollTop((D=U)-T)}if(Q.onRollover){Q.onRollover.apply(I,Q.backwardsCompatible?[t,B,A,V,Q,G]:[V,{data:t,li:B,settings:Q,cache:G,ul:A}])}return B}function y(){var V=A.hide,U=A.show,W=A.data("ac-inputs")||{};if(!A[n]){A.hide=function(X,Y,Z){if(Q.onHide&&O){Q.onHide.call(I,X,{ul:A,settings:Q,cache:G})}O=j;return V.call(A,Y,Z)};A.show=function(X,Y,Z){if(Q.onShow&&!O){Q.onShow.call(I,X,{ul:A,settings:Q,cache:G})}O=c;return U.call(A,Y,Z)};A[n]=c}W[H]=c;return A.data("ac-inputs",W)}function J(W){var X,U,V;if(W===a||W===""){X=U=o.val().length}else{if(r){W=E.substr(0,E.length-E.split(r).pop().length)+W+r}X=E.length;U=W.length;o.val(W)}if(!Q.autoFill||X>U){return j}else{if(I.createTextRange){V=I.createTextRange();if(W===a){V.move("character",X);V.select()}else{V.collapse(c);V.moveStart("character",X);V.moveEnd("character",U);V.select()}}else{if(I.setSelectionRange){I.setSelectionRange(X,U)}else{if(I.selectionStart){I.selectionStart=X;I.selectionEnd=U}}}}return c}function S(V,af,aa,U,Z){v=aa.onLoad?aa.onLoad.call(I,V,{list:af,settings:aa,cache:U,ul:A}):af;if(aa.spinner){aa.spinner.call(I,V,{active:j,settings:aa,cache:U,ul:A})}if(aa.useCache&&U.list[U.val]===a){U.length++;U.list[U.val]=af;if(U.length>aa.cacheLimit){U.list={};U.length=0}}if(!v||v.length<1){return A.html("").hide(V)}u=-1;var ad=o.offset(),W=[],X=0,ab=0,ae=-1,ac=j,Y=v.length;if(aa.onListFormat){aa.onListFormat.call(I,V,{list:v,settings:aa,cache:U,ul:A})}else{for(;++ae<Y;){if(v[ae].value){if(aa.maxItems>-1&&++X>aa.maxItems){break}W.push(aa.striped&&ac?'<li class="'+aa.striped+'">':"<li>",v[ae].display||v[ae].value,"</li>");ac=!ac}}A.html(W.join(""))}F=A.children("li");if(aa.autoFill&&!Z){u=0;t=v[0];J(t.value);B=F.eq(0).addClass(aa.rollover)}A.unbind(".autoComplete").data("ac-input-index",H).delegate("li","mouseleave.autoComplete",function(){if(B){B.removeClass(aa.rollover)}}).delegate("li","mouseenter.autoComplete",function(ag){B=e(this).addClass(aa.rollover);u=F.index(B[0]);t=v[u];if(aa.onRollover){aa.onRollover.apply(I,aa.backwardsCompatible?[t,B,A,ag,aa,U]:[ag,{data:t,li:B,settings:aa,cache:U,ul:A}])}}).bind("click.autoComplete",function(ag){o.trigger("focus",[n]);o.val(E===r?E.substr(0,E.length-E.split(r).pop().length)+t.value+r:t.value);A.hide(ag);J();if(aa.onSelect){aa.onSelect.apply(I,aa.backwardsCompatible?[t,B,A,ag,aa,U]:[ag,{data:t,li:B,settings:aa,cache:U,ul:A}])}}).css({top:ad.top+o.outerHeight(),left:ad.left,width:aa.width}).scrollTop(0);p=F.eq(0).outerHeight();if(aa.maxHeight){A.css({height:p*F.length>aa.maxHeight?aa.maxHeight:"auto",overflow:"auto"})}T=A.outerHeight();D=T;L=p===0?0:Math.floor(D/p);w.timeStamp=(new Date()).getTime();return A.show(V)}y();Q.requestType=Q.requestType.toUpperCase();r=Q.multiple?Q.multipleSeparator:a;g.stack[H]=I;b(o,H)}})(jQuery,window||this);