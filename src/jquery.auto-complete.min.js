/*
 * Auto Complete [VERSION]
 * [DATE]
 * Corey Hart @ http://www.codenothing.com
 */ 
(function(e,h,f){e.fn.autoComplete=function(){var t=r.call(arguments),s=this,x=t.shift(),w=typeof x==="string",v,u;if(w){x=x.replace(n,"-")}t=(p.arrayMethods[x]===g&&e.isArray(t[0])&&e.isArray(t[0][0]))||(t.length===1&&e.isArray(t[0]))?t[0]:t;v=w&&(p.handlerMethods[x]===-1||t.length<(p.handlerMethods[x]||0))?"triggerHandler":"trigger";return w?s[v]("autoComplete."+x,t):x&&x.preventDefault!==f?s.trigger(x,t):s.each(function(){if(e(u=this).data("autoComplete")!==g){m(u,x)}})};function o(w,u){if(o.flag!==g){o.flag=g;j.bind("click.autoComplete",function(x){p.getFocus(g).trigger("autoComplete.document-click",[x])})}var s=w.closest("form"),v=s.data("ac-inputs")||{},t;v[u]=g;s.data("ac-inputs",v);if(s.data("autoComplete")!==g){s.data("autoComplete",g).bind("submit.autoComplete",function(x){return(t=p.getFocus(g)).length?t.triggerHandler("autoComplete.form-submit",[x,this]):g})}}function a(w,u){p.remove(u);if(o.flag===g&&p.length===0){o.flag=q;j.unbind("click.autoComplete")}var s=w.closest("form"),v=s.data("ac-inputs")||{},t;v[u]=q;for(t in v){if(v.hasOwnProperty(t)&&v[t]===g){return}}s.unbind("submit.autoComplete")}function d(w,x){if(!e.isArray(x.supply)){return[]}for(var u=-1,s=x.supply.length,t=[],v;++u<s;){v=x.supply[u];v=v&&v.value?v:{value:v};t.push(v)}return t}function k(){return this}var g=true,q=false,r=Array.prototype.slice,j=e(h.document),l=e(),n=/\./,i=h.opera||(/macintosh/i.test(h.navigator.userAgent)&&e.browser.mozilla),c="autoComplete_"+e.expando,b={backspace:8,tab:9,enter:13,shift:16,space:32,pageup:33,pagedown:34,left:37,up:38,right:39,down:40},p=e.autoComplete={version:"[VERSION]",counter:0,length:0,stack:{},jqStack:{},order:[],hasFocus:q,keys:b,arrayMethods:{"button-supply":g,"direct-supply":g},handlerMethods:{option:2},focus:f,blur:f,getFocus:function(s){return !p.order[0]?s?l:f:s?p.jqStack[p.order[0]]:p.stack[p.order[0]]},getPrevious:function(u){for(var t=0,s=p.order.length;++t<s;){if(p.order[t]){return u?p.jqStack[p.order[t]]:p.stack[p.order[t]]}}return u?l:f},remove:function(u){for(var t=-1,s=p.order.length;++t<s;){if(p.order[t]===u){p.order[t]=f}}p.length--;delete p.stack[u]},getAll:function(){for(var u=-1,t=p.counter,s=[];++u<t;){if(p.stack[u]){s.push(p.stack[u])}}return e(s)},defaults:{backwardsCompatible:q,ajax:"ajax.php",ajaxCache:e.ajaxSettings.cache,dataSupply:[],dataFn:f,formatSupply:f,list:"auto-complete-list",rollover:"auto-complete-list-rollover",width:f,striped:f,maxHeight:f,bgiframe:f,newList:q,postVar:"value",postData:{},postFormat:f,minChars:1,maxItems:-1,maxRequests:0,maxRequestsDeep:q,requestType:"POST",inputControl:f,autoFill:q,nonInput:[b.shift,b.left,b.right],multiple:q,multipleSeparator:" ",onBlur:f,onFocus:f,onHide:f,onLoad:f,onMaxRequest:f,onRollover:f,onSelect:f,onShow:f,onListFormat:f,onSubmit:f,spinner:f,preventEnterSubmit:g,delay:0,useCache:g,cacheLimit:50}},m=function(M,w){p.length++;p.counter++;var s=e(M).attr("autocomplete","off"),V={},A={},I="",z=[],J={length:0},F,H,Y,t,P,S=q,R,B,y=-1,x,v,L=p.counter,u=0,Q=e.fn.bgiframe||e.fn.bgIframe||k,K={length:0,val:f,list:{}},U=e.extend({width:s.outerWidth()},p.defaults,w||{},e.metadata?s.metadata():{}),E=!U.newList&&j.find("ul."+U.list)[0]?Q.call(j.find("ul."+U.list).eq(0),U.bgiframe):Q.call(e("<ul/>").appendTo("body").addClass(U.list).hide().data("ac-selfmade",g),U.bgiframe);e.data(M,"autoComplete",V={index:L,hasFocus:q,active:g,settings:U,initialSettings:e.extend(g,{},U)});if(e.browser.msie){s.bind("keypress.autoComplete",function(Z){if(!V.active){return g}if(Z.keyCode===b.enter){var aa=g;if(F&&F.hasClass(U.rollover)){aa=U.preventEnterSubmit&&S?q:g;O(Z)}else{if(S){E.hide(Z)}}return aa}})}s.bind(i?"keypress.autoComplete":"keydown.autoComplete",function(aa){if(!V.active){return g}var Z=(A=aa).keyCode,ab=q;if(Z===b.tab&&S){O(aa)}else{if(Z===b.enter){ab=g;if(F&&F.hasClass(U.rollover)){ab=U.preventEnterSubmit&&S?q:g;O(aa)}else{if(S){E.hide(aa)}}}else{if(Z===b.up&&S){if(y>0){y--;D(aa)}else{y=-1;s.val(I);E.hide(aa)}}else{if(Z===b.down&&S){if(y<J.length-1){y++;G(aa)}}else{if(Z===b.pageup&&S){if(y>0){y-=P;if(y<0){y=0}D(aa)}}else{if(Z===b.pagedown&&S){if(y<J.length-1){y+=P;if(y>J.length-1){y=J.length-1}G(aa)}}else{if(U.nonInput&&e.inArray(Z,U.nonInput)>-1){E.html("").hide(aa);ab=g}else{return g}}}}}}}A["keydown_"+c]=g;return ab}).bind({"keyup.autoComplete":function(aa){if(!V.active||A["keydown_"+c]){return g}I=s.val();var Z=(A=aa).keyCode,ab=v?I.split(v).pop():I;if(Z!=b.enter){K.val=U.inputControl===f?ab:U.inputControl.apply(M,U.backwardsCompatible?[ab,Z,E,aa,U,K]:[aa,{val:ab,key:Z,settings:U,cache:K,ul:E}]);if(K.val.length>=U.minChars){W(aa,U,K,(Z===b.backspace||Z===b.space))}else{if(Z==b.backspace){E.html("").hide(aa)}}}},"blur.autoComplete":function(Z){if(!V.active||S){return g}if(p.order[0]!==f){p.order.unshift(f)}p.hasFocus=q;V.hasFocus=q;y=-1;E.hide(A=Z);if(p.blur){p.blur.call(M,Z,{settings:U,cache:K,ul:E})}if(U.onBlur){U.onBlur.apply(M,U.backwardsCompatible?[I,E,Z,U,K]:[Z,{val:I,settings:U,cache:K,ul:E}])}},"focus.autoComplete":function(aa,Z){if(!V.active||(V.hasFocus&&Z===c)||A["enter_"+c]){return g}if(L!==E.data("ac-input-index")){E.html("").hide(aa)}if(p.order[0]===f){if(p.order[1]===L){p.order.shift()}else{p.order[0]=L}}else{if(p.order[0]!=L&&p.order[1]!=L){p.order.unshift(L)}}if(p.defaults.cacheLimit!==-1&&p.order.length>p.defaults.cacheLimit){p.order.pop()}p.hasFocus=g;V.hasFocus=g;A=aa;if(p.focus){p.focus.call(M,aa,{settings:U,cache:K,ul:E})}if(U.onFocus){U.onFocus.apply(M,U.backwardsCompatible?[E,aa,U,K]:[aa,{settings:U,cache:K,ul:E}])}},"autoComplete.document-click":function(aa,Z){if(V.active&&S&&(!A||Z.timeStamp-A.timeStamp>200)&&e(Z.target).closest("ul").data("ac-input-index")!==L){E.hide(A=Z);s.blur()}},"autoComplete.form-submit":function(ab,aa,Z){if(!V.active){return g}A=aa;return U.preventEnterSubmit&&(S||A["enter_"+c])?q:U.onSubmit===f?g:U.onSubmit.call(M,aa,{form:Z,settings:U,cache:K,ul:E})},"autoComplete.ul-mouseenter":function(ab,aa,Z){if(F){F.removeClass(U.rollover)}F=e(Z).addClass(U.rollover);y=J.index(Z);x=z[y];H=E.scrollTop()+Y;A=aa;if(U.onRollover){U.onRollover.apply(M,U.backwardsCompatible?[x,F,E,aa,U,K]:[aa,{data:x,li:F,settings:U,cache:K,ul:E}])}},"autoComplete.ul-click":function(aa,Z){s.trigger("focus",[c]);s.val(I===v?I.substr(0,I.length-I.split(v).pop().length)+x.value+v:x.value);E.hide(A=Z);N();if(U.onSelect){U.onSelect.apply(M,U.backwardsCompatible?[x,F,E,Z,U,K]:[Z,{data:x,li:F,settings:U,cache:K,ul:E}])}},"autoComplete.settings":function(ac,Z){if(!V.active){return g}var aa,ab;A=ac;if(e.isFunction(Z)){aa=Z.apply(M,U.backwardsCompatible?[U,K,E,ac]:[ac,{settings:U,cache:K,ul:E}]);if(e.isArray(aa)&&aa[0]!==f){e.extend(g,U,aa[0]||U);e.extend(g,K,aa[1]||K)}}else{e.extend(g,U,Z||{})}Q=e.fn.bgiframe||e.fn.bgIframe||k;E=!U.newList&&E.hasClass(U.list)?E:!U.newList&&(ab=j.find("ul."+U.list).eq(0)).length?Q.call(ab,U.bgiframe):Q.call(e("<ul/>").appendTo("body").addClass(U.list).hide().data("ac-selfmade",g),U.bgiframe);C();U.requestType=U.requestType.toUpperCase();v=U.multiple?U.multipleSeparator:f;V.settings=U},"autoComplete.flush":function(Z,aa){if(!V.active){return g}if(!aa){u=0}K={length:0,val:f,list:{}};A=Z},"autoComplete.button-ajax":function(aa,Z,ab){if(!V.active){return g}if(typeof Z==="string"){ab=Z;Z={}}A=aa;s.trigger("focus",[c]);K.val=ab||"button-ajax_"+c;return W(aa,e.extend(g,{},U,{maxItems:-1,postData:Z||{}}),K)},"autoComplete.button-supply":function(Z,aa,ab){if(!V.active){return g}if(typeof aa==="string"){ab=aa;aa=f}A=Z;s.trigger("focus",[c]);K.val=ab||"button-supply_"+c;aa=e.isArray(aa)?aa:U.dataSupply;return W(Z,e.extend(g,{},U,{maxItems:-1,dataSupply:aa,formatSupply:d}),K)},"autoComplete.direct-supply":function(Z,aa,ab){if(!V.active){return g}if(typeof aa==="string"){ab=aa;aa=f}A=Z;s.trigger("focus",[c]);K.val=ab||"direct-supply_"+c;aa=e.isArray(aa)&&aa.length?aa:U.dataSupply;return X(Z,aa,e.extend(g,{},U,{maxItems:-1,dataSupply:aa,formatSupply:d}),K)},"autoComplete.search":function(Z,aa){if(!V.active){return g}K.val=aa||"";return W(A=Z,U,K)},"autoComplete.option":function(aa,Z,ab){if(!V.active){return g}A=aa;switch(r.call(arguments).length){case 3:U[Z]=ab;return ab;case 2:return Z==="ul"?E:Z==="cache"?K:Z==="xhr"?B:Z==="input"?s:U[Z]||f;default:return U}},"autoComplete.enable":function(Z){V.active=g;A=Z},"autoComplete.disable":function(Z){V.active=q;E.html("").hide(A=Z)},"autoComplete.destroy":function(aa){var ab=E.html("").hide(A=aa).data("ac-inputs")||{},Z;s.removeData("autoComplete").unbind(".autoComplete autoComplete");a(s,L);ab[L]=f;for(Z in ab){if(ab.hasOwnProperty(Z)&&ab[Z]===g){return A}}if(E.data("ac-selfmade")===g){E.remove()}else{E.removeData("autoComplete").removeData("ac-input-index").removeData("ac-inputs")}}});function W(ab,aa,Z,ad,ac){if(aa.maxRequestsDeep===g&&u>=aa.maxRequests){return q}if(aa.spinner){aa.spinner.call(M,ab,{active:g,settings:aa,cache:Z,ul:E})}if(R){R=clearTimeout(R)}if(aa.delay>0&&ac===f){R=h.setTimeout(function(){W(ab,aa,Z,ad,g)},aa.delay);return R}if(B){B.abort()}if(aa.useCache&&e.isArray(Z.list[Z.val])){return X(ab,Z.list[Z.val],aa,Z,ad)}if(aa.dataSupply.length){return T(ab,aa,Z,ad)}if(aa.maxRequests&&++u>=aa.maxRequests){E.html("").hide(ab);if(aa.spinner){aa.spinner.call(M,ab,{active:q,settings:aa,cache:Z,ul:E})}if(aa.onMaxRequest&&u===aa.maxRequests){return aa.onMaxRequest.apply(M,aa.backwardsCompatible?[Z.val,E,ab,I,aa,Z]:[ab,{search:Z.val,val:I,settings:aa,cache:Z,ul:E}])}return q}aa.postData[aa.postVar]=Z.val;B=e.ajax({type:aa.requestType,url:aa.ajax,cache:aa.ajaxCache,dataType:"json",data:aa.postFormat?aa.postFormat.call(M,ab,{data:aa.postData,search:Z.val,val:I,settings:aa,cache:Z,ul:E}):aa.postData,success:function(ae){X(ab,ae,aa,Z,ad)},error:function(){E.html("").hide(ab);if(aa.spinner){aa.spinner.call(M,ab,{active:q,settings:aa,cache:Z,ul:E})}}});return B}function T(aa,ad,Z,ac){var af=[],ah=[],ai=e.isFunction(ad.dataFn),aj=ai?f:new RegExp("^"+Z.val,"i"),ag=0,ak,ae=-1,ab=ad.dataSupply.length;if(ad.formatSupply){af=ad.formatSupply.call(M,aa,{search:Z.val,supply:ad.dataSupply,settings:ad,cache:Z,ul:E})}else{for(;++ae<ab;){ak=ad.dataSupply[ae];ak=ak&&typeof ak.value==="string"?ak:{value:ak};ah=ad.backwardsCompatible?[Z.val,ak.value,af,ae,ad.dataSupply,E,aa,ad,Z]:[aa,{search:Z.val,entry:ak.value,list:af,i:ae,supply:ad.dataSupply,settings:ad,cache:Z,ul:E}];if((ai&&ad.dataFn.apply(M,ah))||(!ai&&ak.value.match(aj))){if(ad.maxItems>-1&&++ag>ad.maxItems){break}af.push(ak)}}}return X(aa,af,ad,Z,ac)}function O(Z){if(S){if(U.onSelect){U.onSelect.apply(M,U.backwardsCompatible?[x,F,E,Z,U,K]:[Z,{data:x,li:F,settings:U,cache:K,ul:E}])}N();I=s.val();if(A.type==="keydown"){A["enter_"+c]=g}E.hide(Z)}F=f}function D(aa){if(F){F.removeClass(U.rollover)}E.show(aa);F=J.eq(y).addClass(U.rollover);x=z[y];if(!F.length||!x){return q}N(x.value);if(U.onRollover){U.onRollover.apply(M,U.backwardsCompatible?[x,F,E,aa,U,K]:[aa,{data:x,li:F,settings:U,cache:K,ul:E}])}var Z=y*t;if(Z<H-Y){H=Z+Y;E.scrollTop(Z)}}function G(aa){if(F){F.removeClass(U.rollover)}E.show(aa);F=J.eq(y).addClass(U.rollover);x=z[y];if(!F.length||!x){return q}N(x.value);var Z=(y+1)*t;if(Z>H){E.scrollTop((H=Z)-Y)}if(U.onRollover){U.onRollover.apply(M,U.backwardsCompatible?[x,F,E,aa,U,K]:[aa,{data:x,li:F,settings:U,cache:K,ul:E}])}}function C(){var aa=E.hide,Z=E.show,ab=E.data("ac-inputs")||{};if(!E[c]){E.hide=function(ac,ad,ae){if(U.onHide&&S){U.onHide.call(M,ac,{ul:E,settings:U,cache:K})}S=q;return aa.call(E,ad,ae)};E.show=function(ac,ad,ae){if(U.onShow&&!S){U.onShow.call(M,ac,{ul:E,settings:U,cache:K})}S=g;return Z.call(E,ad,ae)};E[c]=g}if(E.data("autoComplete")!==g){E.data("autoComplete",g).delegate("li","mouseenter.autoComplete",function(ac){p.getFocus(g).trigger("autoComplete.ul-mouseenter",[ac,this])}).bind("click.autoComplete",function(ac){p.getFocus(g).trigger("autoComplete.ul-click",[ac]);return q})}ab[L]=g;E.data("ac-inputs",ab)}function N(ab){var ac,Z,aa;if(ab===f||ab===""){ac=Z=s.val().length}else{if(v){ab=I.substr(0,I.length-I.split(v).pop().length)+ab+v}ac=I.length;Z=ab.length;s.val(ab)}if(!U.autoFill||ac>Z){return q}else{if(M.createTextRange){aa=M.createTextRange();if(ab===f){aa.move("character",ac);aa.select()}else{aa.collapse(g);aa.moveStart("character",ac);aa.moveEnd("character",Z);aa.select()}}else{if(M.setSelectionRange){M.setSelectionRange(ac,Z)}else{if(M.selectionStart){M.selectionStart=ac;M.selectionEnd=Z}}}}}function X(aa,ah,ae,Z,ad){z=ae.onLoad?ae.onLoad.call(M,aa,{list:ah,settings:ae,cache:Z,ul:E}):ah;if(ae.spinner){ae.spinner.call(M,aa,{active:q,settings:ae,cache:Z,ul:E})}if(ae.useCache&&!e.isArray(Z.list[Z.val])){Z.length++;Z.list[Z.val]=ah;if(ae.cacheLimit!==-1&&Z.length>ae.cacheLimit){Z.list={};Z.length=0}}if(!z||z.length<1){return E.html("").hide(aa)}y=-1;var af=s.offset(),ab=[],aj=0,ag=-1,ai=q,ac=z.length;if(ae.onListFormat){ae.onListFormat.call(M,aa,{list:z,settings:ae,cache:Z,ul:E})}else{for(;++ag<ac;){if(z[ag].value){if(ae.maxItems>-1&&++aj>ae.maxItems){break}ab.push(ae.striped&&ai?'<li class="'+ae.striped+'">':"<li>",z[ag].display||z[ag].value,"</li>");ai=!ai}}E.html(ab.join(""))}J=E.children("li");if(ae.autoFill&&!ad){y=0;x=z[0];N(x.value);F=J.eq(0).addClass(ae.rollover)}E.data("ac-input-index",L).scrollTop(0).css({top:af.top+s.outerHeight(),left:af.left,width:ae.width}).show(aa);t=J.eq(0).outerHeight();if(ae.maxHeight){E.css({height:t*J.length>ae.maxHeight?ae.maxHeight:"auto",overflow:"auto"})}Y=E.outerHeight();H=Y;P=t===0?0:Math.floor(H/t);A.timeStamp=(new Date()).getTime()}C();U.requestType=U.requestType.toUpperCase();v=U.multiple?U.multipleSeparator:f;p.stack[L]=M;p.jqStack[L]=s;o(s,L)}})(jQuery,window||this);