/*
 * Auto Complete [VERSION]
 * [DATE]
 * Corey Hart @ http://www.codenothing.com
 */
(function(g,h){g.fn.autoComplete=function(){var j=c.call(arguments),i=this,l=j.shift(),k=(typeof l==="string");if(k){l=l.replace(".","-")}j=l==="button-supply"||l==="direct-supply"?g.isArray(j[0])&&g.isArray(j[0][0])?j[0]:j:j[1]===h&&g.isArray(j[0])?j[0]:j;return k?i[l==="option"&&j.length<2?"triggerHandler":"trigger"]("autoComplete."+l,j):l&&l[g.expando]?i.trigger(l,j):i.each(function(){a.call(this,l)})};g.fn.bgiframe=g.fn.bgiframe?g.fn.bgiframe:g.fn.bgIframe?g.fn.bgIframe:function(){return this};g.expando=g.expando!==h?g.expando:(function(){var k=g.Event("keyup"),j;for(j in k){if(j.indexOf("jQuery")===0){return j}}return"jQuery"+k.timeStamp})();function b(){return(new Date()).getTime()}var d=true,e=false,c=Array.prototype.slice,f=g.autoComplete={counter:0,length:0,stack:{},order:[],hasFocus:e,getFocus:function(){return this.order[0]?this.stack[this.order[0]]:h},getPrevious:function(){for(var k=0,j=f.order.length;++k<j;){if(f.order[k]){return f.stack[f.order[k]]}}return h},remove:function(n){for(var m=-1,j=f.order.length;++m<j;){if(f.order[m]===n){f.order[m]=h}}f.stack[n]=h;f.length--;delete f.stack[n]},getAll:function(){for(var m=-1,k=f.counter,j=[];++m<k;){if(f.stack[m]){j.push(f.stack[m])}}return g(j)},defaults:{backwardsCompatible:e,ajax:"ajax.php",ajaxCache:g.ajaxSettings.cache,dataSupply:[],dataFn:h,list:"auto-complete-list",rollover:"auto-complete-list-rollover",width:h,striped:h,maxHeight:h,newList:e,postVar:"value",postData:{},postFormat:h,minChars:1,maxItems:-1,maxRequests:0,requestType:"POST",inputControl:h,autoFill:e,nonInput:h,multiple:e,multipleSeparator:" ",onBlur:h,onFocus:h,onHide:h,onLoad:h,onMaxRequest:function(){},onRollover:h,onSelect:h,onShow:h,onSubmit:function(){return d},spinner:h,onListFormat:h,preventEnterSubmit:d,delay:0,useCache:d,cacheLimit:50}},a=function(m){var D=this,i=g(D).attr("autocomplete","off"),H=d,q={},z="",p=[],A={length:0},w,y,O,j,G,J=e,I,s,o=-1,n,l,C=(function(){f.length++;return ++f.counter})(),k=0,B={length:0,val:h,list:{}},L=g.extend({width:i.outerWidth()},f.defaults,m||{},g.metadata?i.metadata():{}),v=!L.newList&&g("ul."+L.list)[0]?g("ul."+L.list).eq(0).bgiframe().data("autoComplete",d):g("<ul/>").appendTo("body").addClass(L.list).bgiframe().hide().data("ac-selfmade",d).data("autoComplete",d),r=g(document).bind("click.autoComplete-"+C,function(Q){var P;if(H&&J&&(!q||Q.timeStamp-q.timeStamp>200)&&(P=g(Q.target)).closest("ul").data("ac-input-index")!==C&&P.data("ac-input-index")!==C){v.hide(Q);i.blur()}q=Q});t();L.requestType=L.requestType.toUpperCase();l=L.multiple?L.multipleSeparator:h;f.stack[C]=D;i.data("autoComplete",d).data("ac-input-index",C).data("ac-active",H).data("ac-initial-settings",g.extend(d,{},L)).data("ac-settings",L).bind(window.opera?"keypress.autoComplete":"keydown.autoComplete",function(Q){if(!H){return d}var P=(q=Q).keyCode,R=e;if(P==9&&J){F(Q)}else{if(P==13&&w){R=L.preventEnterSubmit&&J?e:d;F(Q)}else{if(P==38){if(o>0){o--;u(Q)}else{o=-1;i.val(z);v.hide(Q)}}else{if(P==40){if(o<A.length-1){o++;x(Q)}}else{if(P==33){if(o>0){o-=G;if(o<0){o=0}u(Q)}}else{if(P==34){if(o<A.length-1){o+=G;if(o>A.length-1){o=A.length-1}x(Q)}}else{if(L.nonInput&&g.inArray(P,L.nonInput)){v.html("").hide(Q)}else{return d}}}}}}}q[g.expando+"_autoComplete_keydown"]=d;return R}).bind("keyup.autoComplete",function(Q){if(!H||q[g.expando+"_autoComplete_keydown"]){return d}z=i.val();var P=(q=Q).keyCode,R=l?z.split(l).pop():z;if(P!=13){B.val=L.inputControl===h?R:L.inputControl.apply(D,L.backwardsCompatible?[R,P,v,Q]:[Q,{val:R,key:P,ul:v}]);if(B.val.length>=L.minChars){M(Q,L,B,(P==8||P==32))}else{if(P==8){v.html("").hide(Q)}}}}).bind("blur.autoComplete",function(P){if(!H||J){return d}q=P;i.data("ac-hasFocus",e);o=-1;if(f.order[0]!==h){f.order.unshift(h)}f.hasFocus=e;v.hide(P);if(L.onBlur){L.onBlur.apply(D,L.backwardsCompatible?[z,v,P]:[P,{val:z,ul:v}])}}).bind("focus.autoComplete",function(Q,P){if(!H||(f.focus===C&&P===g.expando+"_autoComplete")||q[g.expando+"_autoComplete_enter"]){return d}q=Q;if(C!=v.data("ac-input-index")){v.html("").hide(Q)}i.data("ac-hasFocus",d);if(f.order[0]===h){if(f.order[1]===C){f.order.shift()}else{f.order[0]=C}}else{if(f.order[0]!=C&&f.order[1]!=C){f.order.unshift(C)}}if(f.order.length>f.defaults.cacheLimit){f.order.pop()}f.hasFocus=d;if(L.onFocus){L.onFocus.apply(D,L.backwardsCompatible?[v,Q]:[Q,{ul:v}])}}).bind("autoComplete.settings",function(R,P){if(!H){return d}if(g.isFunction(P)){var Q=P.apply(D,L.backwardsCompatible?[L,B,v,R]:[R,{settings:L,cache:B,ul:v}]);if(g.isArray(Q)&&Q[0]!==h){L=g.extend(d,{},L,Q[0]||L);B=g.extend(d,{},B,Q[1]||B)}}else{L=g.extend(d,{},L,P||{})}L.requestType=L.requestType.toUpperCase();l=L.multiple?L.multipleSeparator:h;i.data("ac-settings",L);v=!L.newList&&v.hasClass(L.list)?v:!L.newList&&g("ul."+L.list)[0]?g("ul."+L.list).bgiframe().data("autoComplete",d):g("<ul/>").appendTo("body").addClass(L.list).bgiframe().hide().data("ac-selfmade",d).data("autoComplete",d);t();return q=R}).bind("autoComplete.flush",function(P,Q){if(!H){return d}B={length:0,val:h,list:{}};if(!Q){k=0}return q=P}).bind("autoComplete.button-ajax",function(Q,P,R){if(!H){return d}q=Q;i.trigger("focus",[g.expando+"_autoComplete"]);if(typeof P==="string"){R=P;P={}}B.val=R||"NON_404_<>!@$^&";return M(Q,g.extend(d,{},L,{maxItems:-1,postData:P||{}}),B)}).bind("autoComplete.button-supply",function(P,Q,R){if(!H){return d}q=P;i.trigger("focus",[g.expando+"_autoComplete"]);if(typeof Q==="string"){R=Q;Q=h}B.val=R||"NON_404_SUPPLY_<>!@$^&";Q=g.isArray(Q)&&Q.length?Q:L.dataSupply;return M(P,g.extend(d,{},L,{maxItems:-1,dataSupply:Q,dataFn:function(){return d}}),B)}).bind("autoComplete.direct-supply",function(P,Q,R){if(!H){return d}q=P;i.trigger("focus",[g.expando+"_autoComplete"]);if(typeof Q==="string"){R=Q;Q=h}B.val=R||"NON_404_SUPPLY_<>!@$^&";Q=g.isArray(Q)&&Q.length?Q:L.dataSupply;return N(P,Q,g.extend(d,{},L,{maxItems:-1,dataSupply:Q,dataFn:function(){return d}}),B)}).bind("autoComplete.search",function(P,Q){if(!H){return d}B.val=Q||"";return M(q=P,L,B)}).bind("autoComplete.option",function(R){if(!H){return d}q=R;var P=c.call(arguments),Q=P.length;return Q==3?(function(){L[P[1]]=P[2];i.data("ac-settings",L);return P[2]})():Q==2?(function(){switch(P[1]){case"ul":return v;case"cache":return B;case"xhr":return s;case"input":return i;default:return L[P[1]]||h}})():L}).bind("autoComplete.enable",function(P){i.data("ac-active",H=d);return q=P}).bind("autoComplete.disable",function(P){i.data("ac-active",H=e);v.html("").hide(P);return q=P}).bind("autoComplete.destroy",function(Q){i.removeData("autoComplete").removeData("ac-input-index").removeData("ac-initial-settings").removeData("ac-settings").removeData("ac-active").unbind(".autoComplete").unbind("autoComplete."+["settings","flush","button-ajax","button-supply","direct-supply","search","option","enable","disable","destroy"].join(" autoComplete.")).parents("form").eq(0).unbind("submit.autoComplete-"+C);r.unbind("click.autoComplete-"+C);f.remove(C);H=e;var R=v.html("").hide(Q).data("ac-inputs"),P;R[C]=h;for(P in R){if(R[P]===d){return q=Q}}if(v.data("ac-selfmade")===d){v.remove()}return q=Q}).parents("form").eq(0).bind("submit.autoComplete-"+C,function(Q){if(!H){return d}var P=q[g.expando+"_autoComplete_enter"]||e;q=Q;return L.preventEnterSubmit?(J||P)?e:L.onSubmit.call(D,Q,{form:this,ul:v}):L.onSubmit.call(D,Q,{form:this,ul:v})});function M(R,Q,P,T,S){if(Q.spinner){Q.spinner.call(D,R,{active:d,ul:v})}if(I){I=clearTimeout(I)}if(Q.delay>0&&S===h){return I=setTimeout(function(){M(R,Q,P,T,d);I=clearTimeout(I)},Q.delay)}if(s){s.abort()}if(Q.useCache&&P.list[P.val]){return N(R,P.list[P.val],Q,P,T)}if(Q.dataSupply.length){return K(R,Q,P,T)}if(Q.maxRequests&&++k>=Q.maxRequests){v.html("").hide(R);if(Q.spinner){Q.spinner.call(D,R,{active:e,ul:v})}return k>Q.maxRequests?e:Q.onMaxRequest.apply(D,Q.backwardsCompatible?[P.val,v,R,z]:[R,{search:P.val,val:z,ul:v}])}Q.postData[Q.postVar]=P.val;return s=g.ajax({type:Q.requestType,url:Q.ajax,data:Q.postFormat?Q.postFormat.call(D,R,{data:Q.postData,search:P.val,val:z,ul:v}):Q.postData,dataType:"json",cache:Q.ajaxCache,success:function(U){N(R,U,Q,P,T)},error:function(){v.html("").hide(R);if(Q.spinner){Q.spinner.call(D,R,{active:e,ul:v})}}})}function K(Q,T,P,S){var W=[],X=[],Y=g.isFunction(T.dataFn),Z=Y?h:new RegExp("^"+P.val,"i"),U=0,aa,V=0,R=T.dataSupply.length;for(;V<R;V++){aa=T.dataSupply[V];aa=typeof aa==="object"&&aa.value?aa:{value:aa};X=T.backwardsCompatible?[P.val,aa.value,W,V,T.dataSupply,v,Q]:[Q,{val:P.val,entry:aa.value,list:W,i:V,supply:T.dataSupply,ul:v}];if((Y&&T.dataFn.apply(D,X))||(!Y&&aa.value.match(Z))){if(T.maxItems>-1&&++U>T.maxItems){break}W.push(aa)}}return N(Q,W,T,P,S)}function F(P){if(J){if(L.onSelect){L.onSelect.apply(D,L.backwardsCompatible?[n,w,v,P]:[P,{data:n,li:w,ul:v}])}E(h);z=i.val();if(q.type=="keydown"){q[g.expando+"_autoComplete_enter"]=d}}v.hide(P);return w}function u(Q){if(w){w.removeClass(L.rollover)}v.show(Q);w=A.eq(o).addClass(L.rollover);n=p[o];if(!w.length||!n){return e}E(n.value||"");if(L.onRollover){L.onRollover.apply(D,L.backwardsCompatible?[n,w,v,Q]:[Q,{data:n,li:w,ul:v}])}var P=o*j;if(P<y-O){y=P+O;v.scrollTop(P)}return w}function x(Q){if(w){w.removeClass(L.rollover)}v.show(Q);w=A.eq(o).addClass(L.rollover);n=p[o];if(!w.length||!n){return e}E(n.value||"");var P=(o+1)*j;if(P>y){v.scrollTop((y=P)-O)}if(L.onRollover){L.onRollover.apply(D,L.backwardsCompatible?[n,w,v,Q]:[Q,{data:n,li:w,ul:v}])}return w}function t(){if(!v[g.expando+"_autoComplete"]){var Q=v.hide,P=v.show;v.hide=function(S,T,U){if(L.onHide&&J){L.onHide.call(D,S,{ul:v});q[g.expando+"_autoComplete_hide"]=d}J=e;return Q.call(v,T,U)};v.show=function(S,T,U){if(L.onShow&&!J){L.onShow.call(D,S,{ul:v})}J=d;return P.call(v,T,U)};v[g.expando+"_autoComplete"]=d}var R=v.data("ac-inputs")||{};R[C]=d;return v.data("ac-inputs",R)}function E(R){if(R===h){var S,P;S=P=i.val().length}else{if(l){R=z.substr(0,z.length-z.split(l).pop().length)+R+l}var S=z.length,P=R.length;i.val(R)}if(!L.autoFill||S>P){return e}else{if(D.createTextRange){var Q=D.createTextRange();if(R===h){Q.move("character",S);Q.select()}else{Q.collapse(d);Q.moveStart("character",S);Q.moveEnd("character",P);Q.select()}}else{if(D.setSelectionRange){D.setSelectionRange(S,P)}else{if(D.selectionStart){D.selectionStart=S;D.selectionEnd=P}}}}return d}function N(Q,aa,V,P,U){p=V.onLoad?V.onLoad.call(D,Q,{list:aa,settings:V,cache:P,ul:v}):aa;if(V.spinner){V.spinner.call(D,Q,{active:e,ul:v})}if(V.useCache&&P.list[P.val]===h){P.length++;P.list[P.val]=aa;if(P.length>V.cacheLimit){P.list={};P.length=0}}if(!p||p.length<1){return v.html("").hide(Q)}o=-1;if(V.onListFormat){V.onListFormat.call(D,Q,{list:p,settings:V,cache:P,ul:v})}else{var Y=i.offset(),R=[],S=0,W=0,Z=-1,X=e,T=p.length;for(;++Z<T;){if(p[Z].value){if(V.maxItems>-1&&++S>V.maxItems){break}R.push(V.striped&&X?'<li class="'+V.striped+'">':"<li>",p[Z].display||p[Z].value,"</li>");X=!X}}v.html(R.join(""))}A=v.children("li");if(V.autoFill&&!U){o=0;n=p[0];E(n.value||"");w=A.eq(0).addClass(V.rollover)}v.unbind(".autoComplete").data("ac-input-index",C).bind("mouseout.autoComplete",function(){w.removeClass(V.rollover)}).bind("mouseover.autoComplete",function(ab){w=g(ab.target).closest("li");if(w.length<1){return e}A.filter("."+V.rollover).removeClass(V.rollover);o=A.index(w[0]);n=p[o];w.addClass(V.rollover);if(V.onRollover){V.onRollover.apply(D,V.backwardsCompatible?[n,w,v,ab]:[ab,{data:n,li:w,ul:v}])}}).bind("click.autoComplete",function(ab){i.trigger("focus",[g.expando+"_autoComplete"]);i.val(z=l?z.substr(0,z.length-z.split(l).pop().length)+n.value+l:n.value);v.hide(ab);E(h);if(V.onSelect){V.onSelect.apply(D,V.backwardsCompatible?[n,w,v,ab]:[ab,{data:n,li:w,ul:v}])}}).css({top:Y.top+i.outerHeight(),left:Y.left,width:V.width}).scrollTop(0);if(V.maxHeight){v.css({height:j*A.length>V.maxHeight?V.maxHeight:"auto",overflow:"auto"})}O=v.show(Q).outerHeight();y=O;j=A.eq(0).outerHeight();G=Math.floor(y/j);q.timeStamp=b();return v}}})(jQuery);